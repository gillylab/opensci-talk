---
title: "Exposure and confidence"
author: "Julia Stewart Lowndes, PhD  //  lowndes @nceas.ucsb.edu"
date: "October 21, 2016, Hopkins Marine Station, Stanford University"
output:
  ioslides_presentation:
   # smaller: yes
    widescreen: yes
    # logo: figures/OHI_logo.png
  slidy_presentation: default
subtitle: Improving reproducibility, collaboration, and communication in environmental
  science using open science tools
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=2, fig.path='figures/',
                      echo=FALSE, warning=FALSE, message=FALSE)
```
<!---
(while on title slide)
- Really great to be back at HMS, have been looking forward to this talk
- In the last few years I've begun to identify myself not only as a marine scientist and amateur programmer, but as a data scientist and advocate of open science. 

I never thought that I would become a data scientist/programmer. But from my own experience, as well as through teaching other scientists how to program, the main barriers for scientists becoming competent programmers are exposure and confidence. I'm hoping this talk will empower everyone; give you exposure and build confidence

--->

## Exposure and confidence

> - **My origins in programming, data science, and open science**

<!---I think this will resonate with you.  --->

> - **Improving reproducibility, collaboration and communication in environmental science with open science tools**

<!---
- Chance to talk about a paper I'm about to submit as well 
- I'm going to talk about about the tools we use that have fundamentally changed the way we approach science--as much as email did. That's a bold statement because email changed so many things (speed of communication, how many people could be involved in correspondence, attaching data, documentation, images) but it has. 
- These tools have enabled us to get closer to Reproducibility. And one we embarked on because we were not able to fully reproduce our own work when we tried, largely .  

Reproducibiltiy is foundatational to science, but we rarely test it, even with our own work. 
--->

> - **Resources and recommendations**

<!---We find scientists elsewhere are eager to implement open science concepts, but generally have not been exposed to the necessary tools available to suit their needs or lack the knowledge and confidence to begin using them. We've been teaching other scientists--->

## Reproducibility 

Reproducibility is foundatational to science, but we rarely test it, even with our own work. 

Fig of headlines (does this slide fit here)

## Data science and open science 
<!---1/3--->
**Data Science**:  

"an exciting discipline that allows you to turn raw data into understanding, insight, and knowledge"
([*Grolemund & Wickham 2016*](http://r4ds.had.co.nz/))


## Data science and open science 
<!---2/3--->
**Data Science**:  

"an exciting discipline that allows you to turn raw data into understanding, insight, and knowledge"
([*Grolemund & Wickham 2016*](http://r4ds.had.co.nz/))

<img src="figures/r4ds_data-science.png" height="200px"/>

## Data science and open science 
<!---3/3--->
**Data Science**:  

"an exciting discipline that allows you to turn raw data into understanding, insight, and knowledge"
([*Grolemund & Wickham 2016*](http://r4ds.had.co.nz/))

<img src="figures/r4ds_data-science.png" height="200px"/>

**Open Science**:  

"the concept of transparency at all stages of the research process, coupled with free and open access to data, code, and papers" ([*Hampton et al. 2014*](http://onlinelibrary.wiley.com/doi/10.1890/ES14-00402.1/full))


<!--- 
With open science tools, in some ways the benefits of openness are a byproduct of introducing time-saving efficiencies to improve scientific workflows
these tools reduce the headaches that accompany many data-rich workflows, and as a bonus, the resulting science is more transparent, reproducible, and accessible.-
-->


## Data science and open science tools

I primarily use these tools: 

- [**R**](https://cran.r-project.org/)
- [**RStudio**](https://www.rstudio.com/)
- [**git**](https://git-scm.com/)
- [**GitHub**](https://www.github.com/)

TODO: images 

This talk: [jules32.github.io/opensci-talk](http://jules32.github.io/opensci-talk)

<!---

really powerful tools for analysis, collaboration and communication. Will be showing/demoing a bit later, but so you know: 

- this presentation was created with RMarkdown by RStudio
- versioned with git
- shared pubicly with collaborators and you by GitHub. This is the URL if you want to use this as a reference; all these are live links


--->


<!---
I'm going to talk about 2 main open science tools we use and how I couldn't do my job without them. A whole ecosystem of tools and resources to learn them have been developing since I was here at Hopkins and I wish I had had them. So this isn't going to be a normal science talk but more of the tools we use to make our science more reproducible. 

The punchline is that we as environmental scientists, ecologists can be working more efficiently, collaboratively, and reproducibliy than we are. 
There are existing tools and existing resources to learn them that will greatly improve your science and make you more equipped for future projects and jobs. These tools have changed our approach to science as much as email did. 

We made these changes incrementally over 3.5 years and are still improving; can't be an all-at once thing!  We didn't do this overnight; it was an evolution, not a revolution.
--->

## My origins story {.fig_retina}

<img src="figures/_JulieReleaseAugerIMG_9311_reduced.png" height="400px"/>


## Some thesis questions 

> - what are Humboldt squid habitat preferences?
- what season are they most abundant?
- how fast and far can they migrate?
- how do they interact with other species? 
- how do I import my data when it's too big for Excel?
- how do I subset years or other attributes?
- how on earth do I visualize any of this?


## Conflated questions {.smaller .columns-2}

**Science:**

- what are their habitat preferences?
- what season are they most abundant?
- how fast and far can they migrate?
- how do they interact with other species? 
<br>
<br>
<br>

**Data science:** 

- how do I import my data when it's too big for Excel?
- how do I subset years or other attributes?
- how on earth do I visualize any of this?

<!--- 
Conflated science questions
--->

## I learned to program like many do

> - in a panic
- for a single purpose (get this thesis done!)  <!---but it was scripted! Was able to understand now--->
- in near-isolation*
<br>
<br>
<br>

## I learned to program like many do

- in a panic
- for a single purpose (get this thesis done!)  
- in near-isolation*
<br>
<br>
<br>
  
\* Thankfully, I had wonderful programming mentors: 

Steve Haddock, Dave Foley, Ashley Booth

<img src="figures/PCfB_screenshot.png" height="100px"/>

<!---with these mentors I was able to learn Matlab, answer my questions, and graduate! --->


## NCEAS, UC Santa Barbara

TODO: image

<!---Let's continue on to NCEAS where I've grown as a data scientist.  --->

## Ocean Health Index

<!---Without getting into too many details of the project --->

- method to categorize benefits that oceans provide to people 
- scores are modeled using existing data 
- method can be tailored to different geographies
- can help inform policy decisions, especially when repeated

<figure>
<p align = 'center'>
<img src="figures/ohi-goals-flowerplot.png" height="450px" />
</figure>


## OHI Global Assessments

<!---
- Assess coastlines of nations and territories
- Lots of data, ranging from categorical tabular data to high resolution rasters - from nearly one hundred freely available, existing sources

- We were planning to repeat the global assessment annually and also support other groups that wanted to lead their own assessments. 

- highly collaborative
--->

**2012: OHI method and first global assessment** ([*Halpern et al. 2012*](http://www.nature.com/nature/journal/v488/n7413/abs/nature11397.html))

<figure>
<p align = 'center'>
<img src="figures/ohi-map.png" height="400px" />
</figure>


## OHI Global Assessments
<!---
This is when I was hired --->


**2013: second annual global assessment**

> - repeat methods
- update data 
- compare between years

## OHI Global Assessments

**2013: second annual global assessment**

- repeat methods
- update data 
- compare between years  
<br>
<br>  

We expected to easily reproduce our previous work. We had planned ahead: 

<!--- standard approaches to marine science/reproduciblity --->

- coded models
- 130 pages of published supplemental material
- internal documents and notes

## We thought we were doing reproducible science

We struggled to reproduce our work using standard approaches to reproducibility and collaboration 
<!---The effort to develop the first global OHI assessment was highly collaborative, which created additional challenges beyond data preparation. --->

<!--- 
- our workflow was too fragmented, relying on different tools and division of labor
- We quickly realized we needed to improve our workflow.
--->

- added challenge of managing multiple years of information and scores 
- we needed a nimble approach to sharing data, methods, and results within and outside our team 

***Lowndes et al. in prep: Improving reproducibility, collaboration, and communication in environmental
science using open science tools***

underscore the importance of: 

- exposure and confidence
- evolution rather than revolution


## We identified three main challenges to overcome

1) **reproducibility**, including transparency and repeatability, particularly in data preparation
2) **collaboration**, including teamwork and internal collaboration
3) **communication** with scientific and public communities


## Addressing challenges using open science tools

<!---will talk a bit about the cultural changes in reproduciblity and collaboration--->

<figure>
<p align = 'center'>
<img src="https://docs.google.com/drawings/d/19ZBCTq7f-jAzqjaqYK2agrNyw4OvrpdcuOCAHewfxt4/pub?w=960&h=600" height="500px" />
</figure>

<!---large, distributed team structure, division of labor--->

<!---I'm just going to give an example or two of each; will describe before and after; happy to discuss more afters and will let you read the paper when it comes out--->

## Reproducibility - data preparation 

*"Data scientists, according to interviews and expert estimates, spend from 50 percent to 80 percent of their time mired in the mundane labor of collecting and preparing data, before it can be explored for useful information." - [NYTimes (2014)](http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html)*

- transforming, rescaling, gap-filling, formatting, etc
- seldom mentioned but underpins the scientific process

## Reproducibility - data preparation 

*"Data scientists, according to interviews and expert estimates, spend from 50 percent to 80 percent of their time mired in the mundane labor of collecting and preparing data, before it can be explored for useful information." - [NYTimes (2014)](http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html)*

- transforming, rescaling, gap-filling, formatting, etc
- seldom mentioned but underpins the scientific process

Ultimate goal: **Tidy data** *([Wickham 2014](https://www.jstatsoft.org/article/view/v059i10))*

<figure>
<p align = 'center'>
<img src="figures/tidy_data_r4ds.png" height="200px" />
</figure>

## Reproducibility - data preparation 

<!---let me show you what I'm talking about--->

<figure>
<p align = 'center'>
<img src="https://docs.google.com/drawings/d/1_u_GH9go5ksHKiJkUEIaGZleKBOKawEDIGEM0WwAPtI/pub?w=960&h=720" height="500px" />
</figure>


## Reproducibility - data preparation 
<!---ranging from categorical tabular data to high resolution rasters - from nearly one hundred freely available, existing sources--->

**Before**

- manually (without coding)
- largely Microsoft Excel
- internal documents and emails


**After**

- full process coded 
    - R with documentation 
    - RMarkdown

## Reproducibility - data preparation 

Data wrangling with the grammar of data manipulation and tidy data 
<br>
[Grolemund & Wickham 2016: *R for Data Science*](http://r4ds.had.co.nz/tidy-data.html#spreading-and-gathering)
<!---    
- increases readability
- reduces potential for error
--->

<figure>
<p align = 'center'>
<img src="https://docs.google.com/drawings/d/13bmCXXHWK7vzLcgqHsgadevTQq_XgwLnoOvQjO5an1s/pub?w=672&h=480" height="400px" />
</figure>

<!---    
not going to get into this more, but I love talking about this: I teach whole courses on this

can achieve the same operations in half of the lines of code with single functions for deliberate tasks and 'chaining' to minimize temporary variables30,31; this greatly increases readability and reduces the potential for error.

--->

## Reproducibility - version control

<!---    
this is something I did not appreciate the first few times I was introduced to it. I thought, I work alone, I have a fine system of versioning
--->

TODO: version control quote

<figure>
<p align = 'center'>
<img src="figures/JSL_filename_screenshot.png" height="400px" />
</figure>


<!---I'm not even going to ask if this looks familiar because I already know--->

## Reproducibility - version control

**Before**

- filenames suffixed with dates, initials (e.g. `final.csv` and `final_JL-2016-08-05.csv`)
- email descriptions of what changed between files

**After**

- version control with `git`
- short messages accompany commited changes


## Collaboration

TODO: Collaboration quote


<figure>
<p align = 'center'>
<img src="https://docs.google.com/drawings/d/1QXluEeWXV4AYDRgxGhe9VItR1y5mrsNj2--mPdWLgtA/pub?w=672&h=384" height="300px" />
</figure>

## Collaboration

**Before**

- team structure: scientists and single programmer
- discrete tasks: 
    - scientists developed the models conceptually, gathered data, prepared data, interpreted modeled results
    - programmer coded the models. 
- communication + file sharing: email chains (often forwarded). 
- organization: individual conventions on local computers

**After**

- team structure: data scientists
- workflow: (simplified) GitHub workflow

<!---Redesigning our team's workflow required a substantial time investment to learn the tools, and a paradigm shift in our approach to collaboration. Previous to this investment, most team members with any coding experience had learned just enough to accomplish specific tasks (not necessarily in R), and had developed unique conventions. Given the complexity of the project, we needed to learn to code collaboratively and incorporate best practices into our coding25 so that methods for data preparation and modeling could be co-developed and vetted by multiple team members. Further, using a version control system allowed individuals to feel less inhibited about their coding contributions, since files could always be reverted back to previous versions if there were problems.

email chains or memory. This lack of transparency and repeatability was even more problematic for new team members--->

## Communication

**Before**

- published manuscripts
- data on FTP server

**After**

- published manuscripts
- work openly on GitHub [github.com/OHI-Science](https://github.com/ohi-science)
- website with methods, instruction, data [OHI-Science.org](http:ohi-science.org)

## Work in progress

- incremental
- always improving, learning, teaching


## OHI Today

with these efforts, we now have 26 countries interested

demo http://ohi-science.org/

Training (incl. Software Carpentry)



## My recommendations

**Introduce these concepts incrementally: evolution not revolution**

**1 - Learn to code; script your work** 

&nbsp;&nbsp;&nbsp; - in R  
&nbsp;&nbsp;&nbsp; - with RStudio

<!---IDE makes it less intimdating, and so many features for new and seasoned programmers alike--->

**2 - Use version control**

&nbsp;&nbsp;&nbsp; - git  
&nbsp;&nbsp;&nbsp; - with GitHub  
&nbsp;&nbsp;&nbsp; - through RStudio 

Things that helped me: 

<!---What this might mean today is having a lab webpage, and maybe personal webpage, twitter account and a github account --->

http://ohi-science.org/news/Resources-for-R-and-Data-Science

## Becoming a data scientist

![](figures/PracticalDev.png)



##

--> TODO: quote from Woo et al
## 






## Demos of Main tools

- R and RStudio for coding and visualization
- Git for version control, [GitHub](https://github.com) for collaboration 
- GitHub + RStudio for organization, documentation, online publishing, distribution, and communication [ohi-science.org](http://ohi-science.org/)


## Extra slides

## Improving using open science tools

**reproducibility**

- data preparation: coding and documenting
- modeling: `R` functions and packages
- version control
- organization

**collaboration**

- teamwork
- (simplified) GitHub workflow

**communication**

- sharing data and code
- sharing methods and instruction

## My origins in programming and data science

- as a grad student I learned due to panic
- just needed to get the job done
- PCfB
- resistant to version control

<!---Best practices and good enough practices --->

# WSN plug

15-minute version of this talk:  

Friday, Nov 11 

Session 7 'Windjammer' room

